# ğŸ“‚ ë§ˆì´í˜ì´ì§€ ì‚¬ì–‘ v3.2

ì•„ë˜ ì •ì˜ëŠ” *ì—”ë“œíˆ¬ì—”ë“œ UX ëª…ì„¸ v3.1*Â·*ì™€ì´ì–´í”„ë ˆì„ êµ¬ì¡° ì„¤ê³„*Â·*í”„ë¡ íŠ¸ì—”ë“œ API íë¦„ë„* ë“±ì„ í†µí•©â€†/â€†ì„¸ë¶„í™”í•˜ì—¬ **Cursor ìŠ¤ìºí´ë”©ê³¼ Figma í•˜ì´íŒŒì´ ë””ìì¸**ì— ë°”ë¡œ ì ìš©í•  ìˆ˜ ìˆë„ë¡ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.

---

## 1. ì •ë³´ êµ¬ì¡° & ë¼ìš°íŒ…

| ê²½ë¡œ        | ëª©ì                  | ì£¼ìš” í•˜ìœ„ ê²½ë¡œ                                         |
| --------- | ------------------ | ------------------------------------------------ |
| `/mypage` | ë¡œê·¸ì¸ ì‚¬ìš©ìì˜ **í•™ìŠµ í—ˆë¸Œ** | `?tab=overview` `summaries` `quizzes` `settings` |

> **ì „ì—­ ë³´í˜¸ ë¼ìš°íŠ¸** â€“ ê²ŒìŠ¤íŠ¸ ì ‘ê·¼ ì‹œ 401 â†’ ë¡œê·¸ì¸ ëª¨ë‹¬ í›„ ì›ë˜ ê²½ë¡œ ë³µê·€

```
/mypage
 â”œâ”€ overview           # KPI ì¹´ë“œÂ·íˆíŠ¸ë§µ
 â”œâ”€ summaries          # ìš”ì•½ ì¹´ë“œ ë¦¬ìŠ¤íŠ¸
 â”œâ”€ quizzes            # í€´ì¦ˆ/ì˜¤ë‹µ í†µê³„
 â””â”€ settings           # í”„ë¡œí•„Â·í™˜ê²½ì„¤ì •
```

---

## 2. ë ˆì´ì•„ì›ƒ ë° í•µì‹¬ ì»´í¬ë„ŒíŠ¸ ìš”êµ¬ì‚¬í•­

| ì˜ì—­         | ì»´í¬ë„ŒíŠ¸â€†/â€†íŒŒì¼              | í•„ìˆ˜ Prop                     | UX ì„¸ë¶€                              |
| ---------- | ---------------------- | --------------------------- | ---------------------------------- |
| ìƒë‹¨ í—¤ë”      | `Header.tsx`           | `user`, `alerts`            | ì—…ë¡œë“œ FABÂ·ì•Œë¦¼ ë²³ì§€ ê³µí†µ ì‚¬ìš©                |
| íƒ­ ë„¤ë¹„ê²Œì´ì…˜    | `TabNav.tsx`           | `activeTab`                 | Tailwind `border-b-2` + ë¼ìš°í„° push   |
| KPI ì¹´ë“œ     | `KpiCard.tsx`          | `label`, `value`, `delta`   | ìƒ‰ìƒ: +green / -red ìŒì˜               |
| ìº˜ë¦°ë” íˆíŠ¸ë§µ    | `LearningHeatmap.tsx`  | `data[]`                    | `react-calendar-heatmap` + Tooltip |
| ìš”ì•½ ì¹´ë“œ      | `SummaryCard.tsx`      | `subject`, `week`, `status` | Skeleton ë¡œë”©, í´ë¦­ ì‹œ ìš”ì•½ ë·°ì–´            |
| í€´ì¦ˆ íˆìŠ¤í† ë¦¬ ì°¨íŠ¸ | `QuizHistoryChart.tsx` | `scores[]`                  | Recharts LineChart, ì ìˆ˜â‰¥90 % í•˜ì´ë¼ì´íŠ¸  |
| í”„ë¡œí•„ íŒ¨ë„     | `ProfileForm.tsx`      | `userProfile`               | Avatar ì—…ë¡œë“œ + ì¸ë¼ì¸ validation        |
| ì„¤ì • ìŠ¤ìœ„ì¹˜     | `ToggleRow.tsx`        | `label`, `checked`          | ì˜ˆ: â€œì˜¤ë‹µ ì•Œë¦¼ ë°›ê¸°â€                      |

*ëª¨ë°”ì¼(<768 px)* â€“ íƒ­ ë„¤ë¹„ ìœ„ë¡œ sticky, ì¹´ë“œ 1 ì—´ grid.

---

## 3. ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­

### 3-1. íƒ­ë³„ í”Œë¡œìš°

| íƒ­         | ì‹œë‚˜ë¦¬ì˜¤                                   | API              | ìƒíƒœ ì €ì¥ì†Œ             |
| --------- | -------------------------------------- | ---------------- | ------------------ |
| Overview  | ë§ˆìš´íŠ¸ â†’ `/api/stats` í˜¸ì¶œ â†’ KPIÂ·íˆíŠ¸ë§µ ë Œë”     | `GET /stats`     | `useLearningStats` |
| Summaries | ê³¼ëª© ë“œë¡­ë‹¤ìš´ ì„ íƒ â†’ `/api/summaries?subject=` | `GET /summaries` | `useSummaryStore`  |
| Quizzes   | ê¸°ê°„Â·ê³¼ëª© í•„í„° â†’ `/api/quizzes`              | `GET /quizzes`   | `useQuizHistory`   |
| Settings  | ì´ˆê¸° ë¡œë“œ `/api/user` â†’ ìˆ˜ì • í›„ `PUT /user`   | `GET/PUT /user`  | `useProfile`       |

*ëª¨ë“  í˜¸ì¶œ ì‹¤íŒ¨* â€“ `ErrorAlert` + ì¬ì‹œë„ ë²„íŠ¼; Foundry > 30 s íƒ€ì„ì•„ì›ƒ Toast í‘œì‹œ

### 3-2. ìƒíƒœ ì „ì´(XState ìš”ì•½)

```
Idle â†’ Loading â†’ Success
           â†˜ï¸ Error â†—ï¸
```

íƒ­ ê³µí†µ; Error ìƒíƒœì—ì„œ Retry ì´ë²¤íŠ¸ ë°œìƒ ì‹œ Loading ì¬ì§„ì….

---

## 4. í•™ìŠµ í†µê³„ (KPI & ì‹œê°í™”)

| êµ¬ë¶„     | ì§€í‘œ              | ê³„ì‚° ê³µì‹                      | ì»´í¬ë„ŒíŠ¸              |
| ------ | --------------- | -------------------------- | ----------------- |
| ì „ì—­ KPI | **ì´ ìš”ì•½ ìˆ˜**      | summaries.count            | KpiCard           |
|        | **ì´ í€´ì¦ˆ ìˆ˜**      | quizzes.count              | KpiCard           |
|        | **í‰ê·  ì ìˆ˜**       | avg(quizzes.score)         | KpiCard           |
|        | **ìµœê³  ì ìˆ˜**       | max(quizzes.score)         | KpiCard           |
| íˆíŠ¸ë§µ    | **í•™ìŠµ ì„¸ì…˜/ì¼**     | dailySessions              | LearningHeatmap   |
| ì°¨íŠ¸     | **ì ìˆ˜ ì¶”ì´**       | score by `quiz.date`       | QuizHistoryChart  |
| íƒœê·¸     | **ì•½ì  ê°œë… TOP 5** | order by wrong\_count desc | TagCloud (ìƒ‰ìƒ ë‚œì´ë„) |

Supabase ë·° `vw_learning_stats`ì—ì„œ í•œ ë²ˆì— ì§‘ê³„ SELECT ê¶Œì¥.

---

## 5. ì‚¬ìš©ì í”„ë¡œí•„ ê´€ë¦¬

| ê¸°ëŠ¥           | í™”ë©´ ìš”ì†Œ                         | ê²€ì¦Â·ë³´ì•ˆ                              |
| ------------ | ----------------------------- | ---------------------------------- |
| ì•„ë°”íƒ€ ì—…ë¡œë“œ      | Dropzone â†’ `PUT /user/avatar` | S3 Presigned URL, 512 KB ì œí•œ        |
| ë‹‰ë„¤ì„Â·í•™êµÂ·ì „ê³µ ìˆ˜ì • | `InputText`                   | 2â€“20ì, XSS sanitize                |
| ë¹„ë°€ë²ˆí˜¸ ë³€ê²½      | Modal(í˜„ì¬â†’ì‹ ê·œ)                  | 8 ì + ìˆ«ì/íŠ¹ìˆ˜ Â· bcrypt               |
| ì•Œë¦¼ ì„¤ì •        | `ToggleRow`                   | Supabase `notification_prefs` ì—…ë°ì´íŠ¸ |
| ë°ì´í„° ë‚´ë³´ë‚´ê¸°     | ë²„íŠ¼: Zip(ìš”ì•½ md + quiz json)    | ì„œë²„ ì‚¬ì´ë“œ job, URL ë§Œë£Œ 10 min          |
| ê³„ì • ì‚­ì œ        | Danger zone â†’ 2-Step confirm  | GDPR / KISA ì¤€ìˆ˜ â€“ 30 ì¼ ìœ ì˜ˆ           |

í”„ë¡œí•„ ì •ë³´ëŠ” ê³µìš© DB ì¡°íšŒ ì—†ìŒ; ëª¨ë“  í•„ë“œëŠ” **RLS `user_id = auth.uid()`** ì ìš©.

---

## 6. ë””ìì¸ & ì ‘ê·¼ì„± ê°€ì´ë“œ

| í•­ëª©    | ê·œê²©                                                       |
| ----- | -------------------------------------------------------- |
| ì»¬ëŸ¬ í† í° | Primary #2563EB Â· Success #16A34A Â· Error #DC2626        |
| í°íŠ¸    | Noto Sans KR 14 â€“ 18 px ê°€ë³€                               |
| ê·¸ë¦¬ë“œ   | Desktop 12-col 80 px gutter / Mobile 4-col 16 px         |
| ìƒí˜¸ì‘ìš©  | Hover shadow-md â†’ active scale-95 (`transition-100`)     |
| ì• ë‹ˆë©”ì´ì…˜ | KPI ê°’ ì—…ë°ì´íŠ¸ ì‹œ Count-up 0.5 s Â· ì €ì¥ ì„±ê³µ Toast slide-in 0.3 s |
| ì ‘ê·¼ì„±   | ëª¨ë“  KPI ì¹´ë“œ `aria-labelledby`Â·íˆíŠ¸ë§µ `aria-description`       |
| ë°˜ì‘í˜•   | â‰¥1280 px 3 ì—´ grid / 768â€“1279 px 2 ì—´ / MOB 1 ì—´            |
| ì„±ëŠ¥    | Web-vitals LCP â‰¤ 2.5 s, CLS â‰¤ 0.1                        |

---

## 7. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ìš”ì•½

```sql
-- í•™ìŠµ í†µê³„ ë·°
create view vw_learning_stats as
select
  user_id,
  count(distinct summary_id) as summary_cnt,
  count(distinct quiz_id)    as quiz_cnt,
  avg(score)                 as avg_score,
  max(score)                 as max_score
from quiz_results
group by user_id;

-- í†µê³„ íƒœê·¸
create table concept_stats (
  user_id uuid,
  concept text,
  wrong_count int,
  primary key(user_id, concept)
);
```

ëª¨ë“  row RLS: `user_id = auth.uid()` ì ìš©.

---

### âœ… ì™„ë£Œ ê¸°ì¤€ ì²´í¬ë¦¬ìŠ¤íŠ¸

* [x] ë ˆì´ì•„ì›ƒ Â· ì»´í¬ë„ŒíŠ¸ Â· API ëª…ì„¸ê°€ **Cursor í”„ë¡¬í”„íŠ¸**ë¡œ ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
* [x] KPI/ì°¨íŠ¸/íƒœê·¸ ë“± **í•™ìŠµ í†µê³„ í•­ëª©**ì´ ì •ì˜ë˜ì—ˆë‹¤.
* [x] **í”„ë¡œí•„ ê´€ë¦¬** ìˆ˜ì •/ë³´ì•ˆ/ì‚­ì œ í”Œë¡œìš°ê°€ ëª…ì„¸ë˜ì—ˆë‹¤.
* [x] ìƒ‰ìƒÂ·íƒ€ì´í¬Â·ë°˜ì‘í˜•Â·ì ‘ê·¼ì„± í¬í•¨ **ë””ìì¸ ìš”êµ¬ì‚¬í•­**ì´ ëª…í™•í•˜ë‹¤.